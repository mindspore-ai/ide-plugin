plugins {
    id 'java'
    id 'com.github.spotbugs' version "4.7.10"
    id "org.jetbrains.intellij" version "0.6.3"
}

group 'com.mindspore'
version '2.2.0'

intellij {
    type = 'PC'
    version = '2020.3'
    buildSearchableOptions.enabled = false
}

patchPluginXml {
    sinceBuild '193'
    untilBuild '223.*'
}

repositories {
    mavenCentral()
    mavenLocal()
    maven { url 'https://maven.aliyun.com/repository/public/' }
    maven {
        url "https://www.jetbrains.com/intellij-repository/releases"
    }
    maven {
        url "https://cache-redirector.jetbrains.com/intellij-dependencies"
    }
}

dependencies {
    implementation 'com.github.spotbugs:spotbugs-annotations:4.0.1'
    testImplementation 'org.junit.jupiter:junit-jupiter-api:5.7.0'
    testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine:5.7.0'
    testImplementation 'org.mockito:mockito-junit-jupiter:2.23.4'
    testImplementation 'org.powermock:powermock-module-junit4:2.0.2'
    testImplementation 'org.powermock:powermock-api-mockito2:2.0.2'
    testImplementation(fileTree("libs"))
    compileOnly 'org.projectlombok:lombok:1.18.12'
    annotationProcessor 'org.projectlombok:lombok:1.18.12'
    implementation 'net.engio:mbassador:1.3.0'
    implementation "com.google.protobuf:protobuf-java-util:3.7.1"
    implementation "io.grpc:grpc-protobuf:1.33.1"
    implementation "io.grpc:grpc-stub:1.33.1"
    implementation "com.google.protobuf:protobuf-gradle-plugin:0.8.1"
    implementation "io.grpc:grpc-all:1.33.1"
    implementation 'com.vladsch.flexmark:flexmark-all:0.62.2'
    compileOnly(fileTree("libs"))
}

tasks.forEach {
    if (it.name.equals("buildSearchableOptions")) {
        it.enabled = false
    }
}

tasks {
    tasks.withType(JavaCompile) {
        compileJava.options.encoding = 'UTF-8'
        options.encoding = 'UTF-8'
    }
}

spotbugs{
    toolVersion = "4.5.2"
    ignoreFailures = false
    showStackTraces =true
    showProgress = true
    effort = 'default'
    reportLevel = 'default'
    onlyAnalyze = ['com.mindspore.ide.toolkit.*' ]
}